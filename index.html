<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Monteiro Intech - OrÃ§amentos</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="assets/favicon-16x16.png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />

  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script type="module" src="js/main.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="brand">Monteiro Intech</div>
    <div class="topbar-actions">
      <button type="button" id="cart-toggle" class="cart-btn">ğŸ›’ Carrinho</button>
      <button type="button" id="abrir-admin" class="admin-btn">âš™ï¸ Admin</button>
    </div>
  </header>

  <div id="loading" class="loading hidden">
    <div class="spinner"></div>
    <p>Carregando...</p>
  </div>

  <div id="container-admin-carrinho">
    <section id="painel-admin" class="painel-admin hidden">
      <div class="admin-import-box">
        <h3>ğŸ“¥ Importar CatÃ¡logo (CSV â†’ Firestore)</h3>
        <input id="csv-url" type="url" placeholder="Cole a URL direta do CSV (https://...)" class="input-standard" />
        <div class="admin-actions-row">
          <button type="button" id="btn-importar-csv-url" class="btn-secondary-pdf">Importar da URL</button>
          <label class="btn-secondary-pdf clickable-label" for="csv-file">Importar Arquivo</label>
          <input id="csv-file" type="file" accept=".csv,text/csv" hidden />
        </div>
        <div id="import-status" class="status-msg"></div>
        <p class="helper-text">ObservaÃ§Ã£o: URL precisa permitir CORS. Caso contrÃ¡rio, use â€œImportar Arquivoâ€.</p>
      </div>

      <div class="admin-header">
        <h2>Painel Administrativo</h2>
        <button type="button" id="btn-sair-admin" class="btn-exit">Sair</button>
      </div>

      <div id="dashboard-admin" class="dashboard">
        <div class="dash-card"><h3>ğŸ“„ OrÃ§amentos</h3><span id="dash-qtd">0</span></div>
        <div class="dash-card"><h3>ğŸ’° Total</h3><span id="dash-total">R$ 0,00</span></div>
        <div class="dash-card"><h3>ğŸŸ¢ PIX</h3><span id="dash-pix">R$ 0,00</span></div>
        <div class="dash-card"><h3>ğŸ”µ DÃ©bito</h3><span id="dash-debito">R$ 0,00</span></div>
        <div class="dash-card"><h3>ğŸŸ£ CrÃ©dito</h3><span id="dash-credito">R$ 0,00</span></div>
        <div class="dash-card"><h3>ğŸ“ˆ Ticket MÃ©dio</h3><span id="dash-ticket">R$ 0,00</span></div>
        
        <div class="dash-card wide-card">
          <h3>â¬‡ï¸ Baixar Dashboard (por perÃ­odo)</h3>
          <div class="date-filter-row">
            <div class="input-group">
              <label>Data inicial</label>
              <input id="dash-date-start" type="date">
            </div>
            <div class="input-group">
              <label>Data final</label>
              <input id="dash-date-end" type="date">
            </div>
            <button type="button" id="btn-exportar-dashboard" class="btn-secondary-pdf">ğŸ“Š Baixar CSV</button>
          </div>
          <div id="dash-export-status" class="status-msg"></div>
        </div>
      </div>

      <div class="dash-card wide-card">
        <h3>ğŸ§® Atualizar Tabela (colar lista + aplicar custos)</h3>
        <label class="label-bold">Cole aqui a lista:</label>
        <textarea id="tabela-raw" rows="10" class="input-standard"></textarea>

        <div class="cost-grid">
          <div class="input-group">
            <label>MÃ£o de obra (R$)</label>
            <input id="tabela-mao" type="number" step="0.01" value="0">
          </div>
          <div class="input-group">
            <label>Frete (R$)</label>
            <input id="tabela-frete" type="number" step="0.01" value="0">
          </div>
          <div class="input-group">
            <label>Porcentagem (%)</label>
            <input id="tabela-perc" type="number" step="0.01" value="0">
          </div>
        </div>

        <div class="brand-select-row">
          <label>Marca</label>
          <select id="tabela-marca" class="input-standard">
            <option value="Samsung" selected>Samsung</option>
            <option value="Motorola">Motorola</option>
            <option value="Xiaomi">Xiaomi</option>
            <option value="Apple">Apple (iPhone)</option>
            <option value="LG">LG</option>
            <option value="Infinix">Infinix</option>
            <option value="Outros">Outros</option>
          </select>
        </div>

        <div class="admin-actions-row">
          <button type="button" id="tabela-preview" class="btn-secondary-pdf">PrÃ©-visualizar</button>
          <button type="button" id="tabela-aplicar" class="btn-primary-wa">Aplicar no Firebase</button>
        </div>
        <div id="tabela-status" class="status-msg"></div>
        <div id="tabela-preview-box" class="preview-box"></div>
        <p class="helper-text">FÃ³rmula: (preÃ§o_base + mÃ£o_de_obra + frete) Ã— (1 + %/100)</p>
      </div>

      <h2>RelatÃ³rios de OrÃ§amentos</h2>
      <div id="relatorio-lista"></div>
      <button type="button" id="btn-exportar-relatorio" class="btn-secondary-pdf">ğŸ“Š Exportar RelatÃ³rio (Excel)</button>
    </section>

    <aside id="cart-sidebar" class="cart-sidebar hidden">
      <div class="cart-header">
        <h3>Seu OrÃ§amento</h3>
        <button type="button" id="cart-close" class="close-btn">âœ•</button>
      </div>
      <div id="cart-items" class="cart-items"></div>
      <div class="cart-footer">
        <div id="cart-total" class="cart-total">Total: R$ 0,00</div>
        <button type="button" id="btn-open-wa" class="btn-primary-wa">ğŸš€ Finalizar no WhatsApp</button>
        <button type="button" id="btn-gerar-pdf" class="btn-secondary-pdf">ğŸ“„ Gerar PDF</button>
        <button type="button" id="btn-clear-cart" class="btn-clear-link">Limpar Carrinho</button>
      </div>
    </aside>

    <main id="main-content" class="container">
      <section id="lista-servicos">
        <div class="hero-home">
          <h1>Bem-vindo Ã  Monteiro Intech</h1>
          <p>Aqui a confianÃ§a que se instala com um clique.</p>
        </div>
      </section>
    </main>
  </div>

  <div id="modal-orcamento" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-content modal-central">
      <div class="modal-header">
        <h3>Confirmar OrÃ§amento</h3>
        <button type="button" id="modal-orcamento-fechar" class="close-btn">âœ•</button>
      </div>
      <div class="modal-body">
        <label for="cliente-nome">Nome do Cliente:</label>
        <input type="text" id="cliente-nome" placeholder="Digite o nome..." required />
        <label for="forma-pagamento">Forma de Pagamento:</label>
        <select id="forma-pagamento">
          <option value="">Selecione...</option>
          <option value="PIX">PIX</option>
          <option value="Debito">DÃ©bito</option>
          <option value="Credito">CrÃ©dito</option>
        </select>
        <select id="parcelas" class="hidden">
          <option value="1">1x (Com Juros)</option>
          <option value="2">2x (Com Juros)</option>
          <option value="3">3x (Com Juros)</option>
          <option value="4">4x (Com Juros)</option>
          <option value="5">5x (Com Juros)</option>
          <option value="6">6x (Com Juros)</option>
        </select>
      </div>
      <div class="modal-footer">
        <button type="button" id="btn-confirmar-orcamento" class="btn btn-primary-wa">Confirmar</button>
      </div>
    </div>
  </div>

  <div id="modal-admin-login" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-content modal-central">
      <div class="modal-header">
        <h3>Acesso Admin</h3>
        <button type="button" id="modal-admin-fechar" class="close-btn">âœ•</button>
      </div>
      <div class="modal-body">
        <label for="admin-pass">Senha:</label>
        <input type="password" id="admin-pass" placeholder="Digite a senha..." autocomplete="current-password" />
        <p id="admin-err" class="error-msg">Senha invÃ¡lida.</p>
      </div>
      <div class="modal-footer">
        <button type="button" id="btn-admin-entrar" class="btn-secondary-pdf">Entrar</button>
      </div>
    </div>
  </div>

  <footer class="rodape-intech">
    <h3>Monteiro Intech</h3>
    <p>ConfianÃ§a que se instala com um clique.</p>
    <div class="social-links">
      <a href="https://wa.me/5555997005039" target="_blank" rel="noopener noreferrer">WhatsApp</a>
      <a href="https://www.instagram.com/intech.monteiro/" target="_blank" rel="noopener noreferrer">Instagram</a>
      <a href="https://www.facebook.com/intech.monteiro?locale=pt_BR" target="_blank" rel="noopener noreferrer">Facebook</a>
    </div>
    <p class="creditos">Â© 2025 Monteiro Intech â€” Todos os direitos reservados.</p>
  </footer>
</body>
</html>